angular.module("KnowledgePortal",["ngResource","globals","factories"]).config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,c){c.defaults.headers.get={Accept:"application/json, text/javascript, */*"},a.when("/ContactUs",{controller:"StepOneController",templateUrl:"views/stepOne.html"}).when("/StepTwo",{controller:"StepTwoController",templateUrl:"views/stepTwo.html"}).when("/Verify",{controller:"VerifyController",templateUrl:"views/confirmation.html"}).when("/Complete",{controller:"CompleteController",templateUrl:"views/complete.html"}).otherwise({redirectTo:"/ContactUs"})}]).controller("StepOneController",["$scope","$location","$timeout",function(a,b,c){var d=sessionStorage.stepOne,e=sessionStorage.vehicleInfo,f=sessionStorage.complete;if(sessionStorage.removeItem("vehicles"),void 0!==d){var g=sessionStorage.getItem("stepOne"),h=JSON.parse(g),i={fillIt:function(){a.email=h.email,a.fn=h.firstname,a.lastname=h.lastname,a.phone=h.phone,a.subject=h.subject,a.customernumber=h.custnumber}};c(i.fillIt,100)}a.setText=function(a){var b=$("#sub option[value='"+a+"']").text();sessionStorage.subj=b},a.next=function(){_gaq.push(["_trackEvent","NEW Contact Form Started!","ContactUs"]);var c={firstname:a.fn,lastname:a.lastname,phone:a.phone,email:a.email,subject:a.subject,custnumber:a.customernumber};"vi"===a.subject?sessionStorage.vehicles=!0:(sessionStorage.removeItem("vehicleInfo"),sessionStorage.removeItem("vehicles")),"vi"===a.subject&&f&&void 0===e&&sessionStorage.removeItem("complete"),sessionStorage.setItem("stepOne",JSON.stringify(c)),b.path(sessionStorage.complete?"/Verify":"/StepTwo")}}]).controller("StepTwoController",["$scope","$location","$timeout",function(a,b,c){var d=sessionStorage.stepOne,e=sessionStorage.vehicles,f=sessionStorage.vehicleInfo,g=sessionStorage.description;if(void 0===d&&b.path("/StepOne"),e&&(a.vehicles=!0),void 0!==f&&void 0!==g){var h=sessionStorage.getItem("vehicleInfo"),i=JSON.parse(h),j={fillIt:function(){a.details=sessionStorage.description,a.title=i.title,a.vvin=i.vin,a.vplate=i.plate}};c(j.fillIt,100)}else if(void 0===f&&g){var j={fillIt:function(){a.details=sessionStorage.description}};c(j.fillIt,100)}a.next=function(){if(e){var c={title:a.title,vin:a.vvin,plate:a.vplate};sessionStorage.setItem("vehicleInfo",JSON.stringify(c))}sessionStorage.custnumber=a.customernumber,sessionStorage.description=a.details,b.path("/Verify")},a.back=function(){b.path("/StepOne")}}]).controller("VerifyController",["$scope","$location","ContactFactory",function(a,b,c){function d(){a.verify=!1,b.path("/Complete")}function e(b){a.err=b.status}var f,g,h,i,j=sessionStorage.vehicles,k=sessionStorage.vehicleInfo,l=sessionStorage.stepOne,m=sessionStorage.description,n=sessionStorage.subj,o={};if(a.dis=!0,a.verify=!0,sessionStorage.complete="yes",j?(a.vehicles=!0,a.vary="sing"):a.vary="sec",l||m){f=sessionStorage.getItem("stepOne"),h=JSON.parse(f),o={firstname:h.firstname,lastname:h.lastname,phone:h.phone,email:h.email,subject:h.subject,realSubject:n,custnumber:h.custnumber,description:sessionStorage.description},k&&(g=sessionStorage.getItem("vehicleInfo"),i=JSON.parse(g),o.title=i.title,o.vin=i.vin,o.plate=i.plate),"ot"===h.subject&&(o.realSubject=void 0),void 0!==h.phone&&-1!==h.phone.indexOf("555555")&&(o.phone=void 0),a.subj=n,a.mail=o.email,a.theData=[o];var p={oContactUsFields:o};a.addResponse=function(b){o.response=b,a.dis=!1}}else b.path("/StepOne");a.edit=function(a){b.path("/"+a)},a.next=function(){a.isloading=!0,sessionStorage.setItem("data",JSON.stringify(o)),c.contactInfo({},p,d,e)}}]).controller("CompleteController",["$scope","$location","$timeout",function(a,b,c){var d,e,f=sessionStorage.data;void 0===f?b.path("/ContactUs"):(d=sessionStorage.getItem("data"),f=JSON.parse(d),a.theData=[f],_gaq.push(["_trackEvent","Contact Form Completed!","ContactUs"]),e={fillIt:function(){sessionStorage.clear()}},c(e.fillIt,1500)),a.next=function(){window.location.replace("/")}}]);var base="views/directiveTemplates/";angular.module("directives",[]).directive("placeholder",["$timeout",function(a){if(navigator.userAgent.indexOf("MSIE")<0)return{};if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var b=new Number(RegExp.$1);return b>10?void 0:{link:function(b,c,d){"password"!==d.type&&a(function(){c.val(d.placeholder).focus(function(){$(this).val()==$(this).attr("placeholder")&&$(this).val("")}).blur(function(){""==$(this).val()&&$(this).val($(this).attr("placeholder"))})})}}}}]).directive("button",function(){return{restrict:"E",compile:function(a){a.addClass("orgBtn")}}}).directive("custnumber",["$parse",function(a){return{restrict:"A",link:function(b){var c=$("input").attr("name");b.$watch(c,function(d){d&&-1!==d.indexOf("-")&&11===d.length&&a(c).assign(b,d.replace(/-/g,""))})}}}]),angular.module("factories",[]).factory("message",function(){return[]}).factory("ContactFactory",["$resource",function(a){var b="/apps/WebServicesBackEnd/ContactUs.aspx/SendFields";return a(b,{},{contactInfo:{method:"Post",url:b}})}]);